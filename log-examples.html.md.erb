---
title: Log Messages
owner: Security Engineering
---

<strong><%= modified_date %></strong>

This topic provides information about log messages emitted by <%= vars.product_full %> (<%= vars.product_abbr %>).

<%= vars.product_abbr %> logs events that occur.
You can use these samples to configure a Security Information and Event Management (SIEM)
system, to verify regular activity and generate alerts for file system operations in monitored directories.

##<a id="logs"></a> Log Output Destination

<%= vars.product_abbr %> produces many different logs depending on what operation is being performed.
You can find these logs at `/var/vcap/sys/log/fim/fim.stdout.log`.

##<a id="output-logs"></a> Log Format

<%= vars.product_abbr %> can emit logs in the default format or you can configure a custom format.

###<a id="output-logs"></a> Default Log Format

The default format for <%= vars.product_abbr %> logs is as follows:

```
CEF:0|cloud_foundry|fim|1.0.0|OPERATION-TYPE|file integrity monitoring event|SEVERITY| fname="ABSOLUTE-PATH" hostname="BOSH-VM" opname="OPERATION-NAME" optype=OPERATION-TYPE ts=TIMESTAMP severity=SEVERITY
```

Where:

* `OPERATION-TYPE` and `OPERATION-NAME` are one of the below:
    * `1`, which is `CREATE`
    * `2`, which is `WRITE`
    * `4`, which is `REMOVE`
    * `8`, which is `RENAME`
    * `16`, which is `CHMOD`

* `SEVERITY` is one of the following severity levels:
    * `0`, which is used for heartbeats
    * `3`, which is used for low severity events
    * `5`, which is used for all other events

* `ABSOLUTE-PATH` is the absolute path to the file, for example `/directory/file`

* `BOSH-VM` is the BOSH VM name, for example `/directory/vm-name`

* `TIMESTAMP` is the timestamp in Unix epoch format.


For example:

<pre class="terminal">
CEF:0|cloud_foundry|fim|1.0.0|1|file integrity monitoring event|3| fname="/test/file01" hostname="fim/a6fbc720-cfd1-47fc-a257-c211704924a6" opname="CREATE" optype=1 ts=1546535400 severity=3
CEF:0|cloud_foundry|fim|1.0.0|2|file integrity monitoring event|5| fname="/test/file02" hostname="fim/a6fbc720-cfd1-47fc-a257-c211704924a6" opname="WRITE" optype=2 ts=1546535520 severity=5
</pre>

<p class="note"><strong>Note</strong>:
Low severity events can be used to filter out business-as-usual events.
This allows you to isolate unexpected events by looking for severity <code>5</code>.
You can configure this in the tile using <strong>Low severity tagging for frequently changed files</strong>.<br><br>
For instructions on how to configure which files produce low severity events, see
<a href="./installing.html#configure-ubuntu">Configure FIM for Linux</a> and
<a href="./installing.html#configure-windows">Configure FIM for Windows</a>.
</p>

###<a id="output-logs"></a> Custom Log Format

You can also configure a custom log format using the **Output log format** field.
For more information about configuring this field, see [Output Log Format](./installing.html#format).


##<a id="examples"></a> Examples of Log Messages

This section contains sample log messages emitted by <%= vars.product_abbr %>.
You can use these samples to configure a Security Information and Event Management (SIEM) system.

###<a id="fim-logs-messages"></a> <%= vars.product_abbr %> Log Message Types

For an example of every type of <%= vars.product_abbr %> log message that can be configured, see below:

* `HEARTBEAT`
	<pre class="terminal">
	2019-04-05T16:00:27.353542+00:00 localhost filesnitch[6663]: CEF:0|cloud_foundry|fim|1.0.0|0|file integrity monitoring event|0|<br>
	fname="" hostname="fim\_1/f66479c7-cd37-4a99-b735-f6f41ba55f01" opname="FILESNITCH CHECKIN" optype=0 ts=1554480027 severity=0
	</pre>

* `CREATE`
	<pre class="terminal">
	2019-04-05T15:52:03.296265+00:00 localhost filesnitch[5990]: CEF:0|cloud\_foundry|fim|1.0.0|1|file integrity monitoring event|5|<br>
	fname="/var/vcap/data/jobs/newfile.txt" hostname="fim\_1/f66479c7-cd37-4a99-b735-f6f41ba55f01" opname="CREATE" optype=1 ts=1554479523 severity=5
	</pre>

* `WRITE`
	<pre class="terminal">
	2019-04-05T15:52:22.230901+00:00 localhost filesnitch[5990]: CEF:0|cloud\_foundry|fim|1.0.0|2|file integrity monitoring event|5|<br>
	fname="/var/vcap/data/jobs/file.txt" hostname="fim\_1/f66479c7-cd37-4a99-b735-f6f41ba55f01" opname="WRITE" optype=2 ts=1554479542 severity=5
	</pre>

* `REMOVE`
	<pre class="terminal">
	2019-04-05T15:52:15.636353+00:00 localhost filesnitch[5990]: CEF:0|cloud\_foundry|fim|1.0.0|4|file integrity monitoring event|5|<br>
	fname="/var/vcap/data/jobs/file.txt" hostname="fim\_1/f66479c7-cd37-4a99-b735-f6f41ba55f01" opname="REMOVE" optype=4 ts=1554479535 severity=5
	</pre>

* `RENAME`
	<pre class="terminal">
	2019-04-05T15:52:28.707094+00:00 localhost filesnitch[5990]: CEF:0|cloud\_foundry|fim|1.0.0|8|file integrity monitoring event|5|<br>
	fname="/var/vcap/data/jobs/file.txt" hostname="fim\_1/f66479c7-cd37-4a99-b735-f6f41ba55f01" opname="RENAME" optype=8 ts=1554479548 severity=5
	</pre>

* `CHMOD`
	<pre class="terminal">
	2019-04-05T15:52:03.297424+00:00 localhost filesnitch[5990]: CEF:0|cloud\_foundry|fim|1.0.0|16|file integrity monitoring event|5|<br>
	fname="/var/vcap/data/jobs/newfile.txt" hostname="fim\_1/f66479c7-cd37-4a99-b735-f6f41ba55f01" opname="CHMOD" optype=16 ts=1554479523 severity=5
	</pre>


###<a id="container-examples"></a> Examples of Log Messages from Containers

Examples of <%= vars.product_abbr %> log messages from Garden containers and Docker containers:

* For a Garden container in <%= vars.app_runtime_full %> (<%= vars.app_runtime_abbr %>)
<pre class="terminal">
CEF:0|cloud_foundry|fim|1.0.0|1|file integrity monitoring event|5|
fname="/var/vcap/data/grootfs/store/unprivileged/images/5c320add-ac1a-4bd7-78b6-1129/diff/home/vcap/app/public/test.html"
</pre>

* For a Windows Garden container in <%= vars.windows_runtime_full %> (<%= vars.windows_runtime_abbr %>)
<pre class="terminal">
CEF:0|cloud_foundry|fim|1.0.0|1|file integrity monitoring event|5|
fname="C:\\proc\\8174\\root\\Users\\vcap\\app\\test.html"
hostname="windows_diego_cell/be1f4854-299d-47d1-98eb-60b0741a3f6b" opname="CREATE" optype=1 ts=1556218123 severity=5
</pre>

* For a Docker container in <%= vars.k8s_runtime_full %> (<%= vars.k8s_runtime_abbr %>)
<pre class="terminal">
CEF:0|cloud_foundry|fim|1.0.0|1|file integrity monitoring event|5|
fname="/var/vcap/store/docker/docker/overlay2/7e5685c735b2aa97a9680e0b81730a518e3188afbf0f9f1529e492f98ed35f1d/diff/test.html"
hostname="worker/d1d67195-ad42-4025-83e9-0d43a193ad53" opname="CREATE" optype=1 ts=1556217648 severity=5
</pre>

For how to configure <%= vars.product_abbr %> to monitor containers,
see [Monitor Containers with <%= vars.product_abbr %>](./installing.html#monitor-containers).
